{
  "resourceType": "PlanDefinition",
  "id": "opioidcds-12-patient-view",
  "meta": {
    "profile": [ "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-recommendationdefinition", "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-publishableplandefinition" ]
  },
  "extension": [ {
    "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability",
    "valueCode": "shareable"
  }, {
    "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability",
    "valueCode": "computable"
  }, {
    "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability",
    "valueCode": "executable"
  }, {
    "url": "http://hl7.org/fhir/uv/cpg/StructureDefinition/cpg-knowledgeCapability",
    "valueCode": "publishable"
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Get Summary"
    }, {
      "url": "statement",
      "valueString": "define \"Get Summary\":\n  if \"Is Recommendation Applicable?\"\n    then 'Recommend opioid agonist or partial agonist treatment with methadone maintenance therapy or buprenorphine and/or behavioral therapy'\n  else null"
    }, {
      "url": "displaySequence",
      "valueInteger": 0
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSCommonConfig"
    }, {
      "url": "name",
      "valueString": "Age Less than 18 Years Is Enabled"
    }, {
      "url": "statement",
      "valueString": "// Opioid Review Useful\ndefine \"Age Less than 18 Years Is Enabled\":\n  true"
    }, {
      "url": "displaySequence",
      "valueInteger": 1
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Patient 18 or Older?"
    }, {
      "url": "statement",
      "valueString": "define \"Patient 18 or Older?\":\n  Config.\"Age Less than 18 Years Is Enabled\"\n    and AgeInYears() >= 18"
    }, {
      "url": "displaySequence",
      "valueInteger": 2
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSCommonConfig"
    }, {
      "url": "name",
      "valueString": "Evidence Based Treatment Criteria For Opioid Use Disorder"
    }, {
      "url": "statement",
      "valueString": "// Recommendation 12\ndefine \"Evidence Based Treatment Criteria For Opioid Use Disorder\":\n  true"
    }, {
      "url": "displaySequence",
      "valueInteger": 3
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Opioid Use Disorder Lookback Period"
    }, {
      "url": "statement",
      "valueString": "define \"Opioid Use Disorder Lookback Period\":\n  Interval[Today() - 90 days, Today()]"
    }, {
      "url": "displaySequence",
      "valueInteger": 4
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Not Receiving Evidence-Based Treatment for Opioid Use Disorder"
    }, {
      "url": "statement",
      "valueString": "define \"Not Receiving Evidence-Based Treatment for Opioid Use Disorder\":\n  Config.\"Evidence Based Treatment Criteria For Opioid Use Disorder\"\n    and not (\n      exists (\n        [MedicationRequest: Common.\"Buprenorphine and methadone medications\"] MR\n          where MR.status in { 'active', 'completed' }\n            and date from MR.authoredOn during day of \"Opioid Use Disorder Lookback Period\"\n      )\n      or exists (\n        [Procedure: Common.\"Substance misuse behavioral counseling\"] P\n          where P.status ~ 'completed'\n            and (\n              case\n                when P.performed is FHIR.dateTime then\n                  Interval[FHIRHelpers.ToDateTime(P.performed as FHIR.dateTime), FHIRHelpers.ToDateTime(P.performed as FHIR.dateTime)]\n                when P.performed is FHIR.Period then\n                  FHIRHelpers.ToInterval(P.performed as FHIR.Period)\n                else\n                  null as Interval<DateTime>\n                end\n            ) during day of \"Opioid Use Disorder Lookback Period\"\n      )\n    )"
    }, {
      "url": "displaySequence",
      "valueInteger": 5
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSCommon"
    }, {
      "url": "name",
      "valueString": "US Core-Categorized Conditions"
    }, {
      "url": "statement",
      "valueString": "// 3. Medications indicating end of life\n    /* or exists (\n      \"Medications Indicating End of Life\"\n    ) */\ndefine \"US Core-Categorized Conditions\":\n  [Condition: category in \"Encounter Diagnosis Condition Category\"]\n    union [Condition: category in \"Problem List Condition Category\"]\n    union [Condition: category in \"US Core Health Concern Condition Category\"]"
    }, {
      "url": "displaySequence",
      "valueInteger": 6
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Presence of Diagnosis of Opioid Use Disorder"
    }, {
      "url": "statement",
      "valueString": "define \"Presence of Diagnosis of Opioid Use Disorder\":\n  exists (\n    Common.\"US Core-Categorized Conditions\" C\n      where C.code in Common.\"Opioid misuse disorders\"\n        and C.clinicalStatus in Common.\"Active Condition\"\n        and date from C.recordedDate during day of \"Opioid Use Disorder Lookback Period\"\n    )"
    }, {
      "url": "displaySequence",
      "valueInteger": 7
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Positive Result from Opioid Use Disorder Evaluation Tool"
    }, {
      "url": "statement",
      "valueString": "define \"Positive Result from Opioid Use Disorder Evaluation Tool\":\n  true"
    }, {
      "url": "displaySequence",
      "valueInteger": 8
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Inclusion Criteria"
    }, {
      "url": "statement",
      "valueString": "define \"Inclusion Criteria\":\n  \"Patient 18 or Older?\"\n    and \"Not Receiving Evidence-Based Treatment for Opioid Use Disorder\"\n    and \"Presence of Diagnosis of Opioid Use Disorder\"\n    and \"Positive Result from Opioid Use Disorder Evaluation Tool\""
    }, {
      "url": "displaySequence",
      "valueInteger": 9
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Exclusion Criteria"
    }, {
      "url": "statement",
      "valueString": "define \"Exclusion Criteria\":\n  false"
    }, {
      "url": "displaySequence",
      "valueInteger": 10
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Is Recommendation Applicable?"
    }, {
      "url": "statement",
      "valueString": "define \"Is Recommendation Applicable?\":\n  \"Inclusion Criteria\"\n    and not \"Exclusion Criteria\""
    }, {
      "url": "displaySequence",
      "valueInteger": 11
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Get Detail"
    }, {
      "url": "statement",
      "valueString": "define \"Get Detail\":\n  if \"Is Recommendation Applicable?\"\n    then null\n  else null"
    }, {
      "url": "displaySequence",
      "valueInteger": 12
    } ]
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
    "extension": [ {
      "url": "libraryName",
      "valueString": "OpioidCDSREC12PatientView"
    }, {
      "url": "name",
      "valueString": "Get Indicator"
    }, {
      "url": "statement",
      "valueString": "define \"Get Indicator\":\n  if \"Is Recommendation Applicable?\"\n    then 'warning'\n  else null"
    }, {
      "url": "displaySequence",
      "valueInteger": 13
    } ]
  } ],
  "url": "http://fhir.org/guides/cdc/opioid-cds/PlanDefinition/opioidcds-12-patient-view",
  "identifier": [ {
    "use": "official",
    "value": "cdc-opioid-guidance"
  } ],
  "version": "0.1.1",
  "name": "PlanDefinition_Recommendation_12_Patient_View",
  "title": "PlanDefinition - CDC 2016 Opioid Prescribing Guideline Recommendation #12 (patient-view)",
  "type": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/plan-definition-type",
      "code": "eca-rule",
      "display": "ECA Rule"
    } ]
  },
  "status": "draft",
  "experimental": true,
  "date": "2019-08-01",
  "publisher": "Centers for Disease Control and Prevention (CDC)",
  "description": "Arrange evidence-based treatment (usually medication-assisted treatment with buprenorphine or methadone in combination with behavioral therapies) for patients with opioid use disorder.",
  "useContext": [ {
    "code": {
      "system": "http://terminology.hl7.org/CodeSystem/usage-context-type",
      "code": "focus",
      "display": "Clinical Focus"
    },
    "valueCodeableConcept": {
      "coding": [ {
        "system": "http://snomed.info/sct",
        "code": "182888003",
        "display": "Medication requested (situation)"
      } ]
    }
  }, {
    "code": {
      "system": "http://terminology.hl7.org/CodeSystem/usage-context-type",
      "code": "focus",
      "display": "Clinical Focus"
    },
    "valueCodeableConcept": {
      "coding": [ {
        "system": "http://snomed.info/sct",
        "code": "82423001",
        "display": "Chronic pain (finding)"
      } ]
    }
  } ],
  "jurisdiction": [ {
    "coding": [ {
      "system": "urn:iso:std:iso:3166",
      "code": "US",
      "display": "United States of America"
    } ]
  } ],
  "purpose": "CDC's Guideline for Prescribing Opioids for Chronic Pain is intended to improve communication between providers and patients about the risks and benefits of opioid therapy for chronic pain, improve the safety and effectiveness of pain treatment, and reduce the risks associated with long-term opioid therapy, including opioid use disorder and overdose. The Guideline is not intended for patients who are in active cancer treatment, palliative care, or end-of-life care.",
  "usage": "Clinicians should offer or arrange evidence-based treatment (usually medication-assisted treatment with buprenorphine or methadone in combination with behavioral therapies) for patients with opioid use disorder.",
  "copyright": "© CDC 2016+.",
  "topic": [ {
    "text": "Opioid Prescribing"
  } ],
  "author": [ {
    "name": "Kensaku Kawamoto, MD, PhD, MHS"
  }, {
    "name": "Bryn Rhodes"
  }, {
    "name": "Floyd Eisenberg, MD, MPH"
  }, {
    "name": "Robert McClure, MD, MPH"
  } ],
  "relatedArtifact": [ {
    "type": "documentation",
    "display": "CDC 2016 Guideline for prescribing opioids for chronic pain",
    "url": "https://www.cdc.gov/mmwr/volumes/65/rr/rr6501e1.htm?CDC_AA_refVal=https%3A%2F%2Fwww.cdc.gov%2Fmmwr%2Fvolumes%2F65%2Frr%2Frr6501e1er.htm"
  } ],
  "library": [ "http://fhir.org/guides/cdc/opioid-cds/Library/OpioidCDSREC12PatientView" ],
  "action": [ {
    "title": "Current patient is 18 or older and recieving evidence-based treatment for Opioid Misuse Disorders.",
    "_title": {
      "fhir_comments": [ " non-dynamic card summary " ]
    },
    "description": "Checking if the trigger prescription meets the inclusion criteria for recommendation #12 workflow.",
    "documentation": [ {
      "type": "documentation",
      "document": {
        "extension": [ {
          "fhir_comments": [ " We can use the example code systems from the FHIR Clinical Reasoning Module, or we can define GRADE specific code systems and use those here " ],
          "url": "http://hl7.org/fhir/StructureDefinition/cqf-strengthOfRecommendation",
          "valueCodeableConcept": {
            "coding": [ {
              "system": "http://terminology.hl7.org/CodeSystem/recommendation-strength",
              "code": "strong",
              "display": "Strong"
            } ]
          }
        }, {
          "url": "http://hl7.org/fhir/StructureDefinition/cqf-qualityOfEvidence",
          "valueCodeableConcept": {
            "coding": [ {
              "system": "http://terminology.hl7.org/CodeSystem/evidence-quality",
              "code": "moderate",
              "display": "Moderate quality"
            } ]
          }
        } ]
      }
    } ],
    "trigger": [ {
      "type": "named-event",
      "name": "patient-view"
    } ],
    "condition": [ {
      "kind": "applicability",
      "expression": {
        "description": "Check whether the current patient is 18 or older and recieving evidence-based treatment for Opioid Misuse Disorders.",
        "language": "text/cql.identifier",
        "expression": "Is Recommendation Applicable?"
      }
    } ],
    "groupingBehavior": "visual-group",
    "selectionBehavior": "any",
    "dynamicValue": [ {
      "path": "action.title",
      "expression": {
        "language": "text/cql.identifier",
        "expression": "Get Summary"
      }
    }, {
      "path": "action.description",
      "expression": {
        "language": "text/cql.identifier",
        "expression": "Get Detail"
      }
    }, {
      "path": "activity.extension",
      "expression": {
        "language": "text/cql.identifier",
        "expression": "Get Indicator"
      }
    } ],
    "action": [ {
      "description": "Will order methadone or buprenorphine"
    }, {
      "description": "Will also refer to qualified treatment provider (i.e., substance disorder specialist)"
    }, {
      "description": "N/A - see comment, snooze 3 months"
    } ]
  } ]
}